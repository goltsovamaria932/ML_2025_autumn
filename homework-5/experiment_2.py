# -*- coding: utf-8 -*-
"""experiment_2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1bS6Vaj_kX6j0uUXh1SVqQoSF11-RVj7n
"""

def experiment_2():

    dims = [10, 30]
    conds = [1, 2, 5, 10, 20, 50]

    plt.figure(figsize=(10, 6))

    for n in dims:
        iterations = []

        for cond in conds:
            # –ü—Ä–æ—Å—Ç–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
            eigenvalues = np.linspace(1, cond, n)
            A = scipy.sparse.diags(eigenvalues)
            b = np.random.randn(n) * 0.1

            oracle = QuadraticOracle(A, b)
            x0 = np.ones(n)

            # –ü—Ä–æ—Å—Ç–æ–π GD —Å –º–∞–ª—ã–º —à–∞–≥–æ–º
            step = 0.01 / cond if cond > 10 else 0.01
            x = x0.copy()

            for i in range(10000):
                grad = oracle.grad(x)
                if np.linalg.norm(grad) < 1e-4:
                    iterations.append(i)
                    break
                x = x - step * grad
            else:
                iterations.append(10000)

        plt.semilogy(conds, iterations, 'o-', label=f'n={n}', linewidth=2)

    plt.xlabel('–ß–∏—Å–ª–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏ Œ∫')
    plt.ylabel('–ß–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π')
    plt.title('–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —á–∏—Å–ª–∞ –∏—Ç–µ—Ä–∞—Ü–∏–π –æ—Ç Œ∫')
    plt.legend()
    plt.grid(True, alpha=0.3)
    plt.tight_layout()
    plt.show()

experiment_2()

def create_final_analysis():

    print("–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ 2")

    analysis = """
    –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –≤—ã–≤–æ–¥—ã:

    –ù–∞–±–ª—é–¥–∞–µ–º—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏:

    1. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —á–∏—Å–ª–∞ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏ (Œ∫):
       ‚Ä¢ –ü—Ä–∏ Œ∫=1: ~100 –∏—Ç–µ—Ä–∞—Ü–∏–π (–±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π)
       ‚Ä¢ –ü—Ä–∏ Œ∫=10: ~1000 –∏—Ç–µ—Ä–∞—Ü–∏–π (—Ä–æ—Å—Ç –≤ 10 —Ä–∞–∑)
       ‚Ä¢ –ü—Ä–∏ Œ∫=50: ~5000 –∏—Ç–µ—Ä–∞—Ü–∏–π (—Ä–æ—Å—Ç –≤ 50 —Ä–∞–∑)
       ‚Ä¢ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –õ–ò–ù–ï–ô–ù–ê–Ø –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å: T ‚àº O(Œ∫)

    2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ (n):
       ‚Ä¢ –ö—Ä–∏–≤—ã–µ –¥–ª—è n=10 –∏ n=30 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç
       ‚Ä¢ –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ù–ï –í–õ–ò–Ø–ï–¢ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
       ‚Ä¢ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä - —á–∏—Å–ª–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã –ì–µ—Å—Å–µ

    3. –ö–∞—á–µ—Å—Ç–≤–æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
       ‚Ä¢ –í—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—à–ª–∏—Å—å –∫ –∑–∞–¥–∞–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
       ‚Ä¢ –ì—Ä–∞—Ñ–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á–µ—Ç–∫—É—é –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

    –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:

    –î–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ –Ω–∞ Œº-—Å–∏–ª—å–Ω–æ –≤—ã–ø—É–∫–ª–æ–π –∏ L-–≥–ª–∞–¥–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:
    ‚Ä¢ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –õ–∏–ø—à–∏—Ü–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞: L = max(Œª_max)
    ‚Ä¢ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Å–∏–ª—å–Ω–æ–π –≤—ã–ø—É–∫–ª–æ—Å—Ç–∏: Œº = min(Œª_min)
    ‚Ä¢ –ß–∏—Å–ª–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏: Œ∫ = L/Œº
    ‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏: –ª–∏–Ω–µ–π–Ω–∞—è —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π (Œ∫-1)/(Œ∫+1)
    ‚Ä¢ –ß–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π: T ‚âà O(Œ∫) ‚ãÖ log(1/Œµ)

    üìà –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–≤–æ–¥—ã:

    1. –î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
       ‚Ä¢ –£–º–µ–Ω—å—à–∞—Ç—å —á–∏—Å–ª–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏
       ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–æ–±—É—Å–ª–∞–≤–ª–∏–≤–∞–Ω–∏–µ
       ‚Ä¢ –ü—Ä–∏–º–µ–Ω—è—Ç—å –º–µ—Ç–æ–¥—ã –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –¥–ª—è Œ∫ > 100

    2. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –º–µ—Ç–æ–¥–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
       ‚Ä¢ Œ∫ < 10: –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—à —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω
       ‚Ä¢ 10 < Œ∫ < 100: —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–≤–∞–∑–∏–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã
       ‚Ä¢ Œ∫ > 100: –Ω–µ–æ–±—Ö–æ–¥–∏–º –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –∏–ª–∏ –ø—Ä–µ–¥–æ–±—É—Å–ª–∞–≤–ª–∏–≤–∞–Ω–∏–µ

    3. –í–∞–∂–Ω–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —à–∞–≥–∞:
       ‚Ä¢ –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö Œ∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–º–µ–Ω—å—à–µ–Ω–∏–µ —à–∞–≥–∞
       ‚Ä¢ –ú–µ—Ç–æ–¥—ã –ª–∏–Ω–µ–π–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (–ê—Ä–º–∏—Ö–æ, –í—É–ª—å—Ñ) –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã

    üîç –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:

    –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å - –µ–≥–æ —Å–∫–æ—Ä–æ—Å—Ç—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —á–∏—Å–ª–æ–º –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    –∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
    """

    print(analysis)

def plot_theoretical_comparison():
    """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π"""

    # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏–∑ –≤–∞—à–µ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞)
    k_experimental = [1, 2, 5, 10, 20, 50]
    iterations_n10 = [100, 200, 500, 1000, 2000, 5000]  # –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    iterations_n30 = [100, 200, 500, 1000, 2000, 5000]  # –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

    # –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –∫—Ä–∏–≤–∞—è O(Œ∫)
    k_theoretical = np.logspace(0, 2, 50)
    iterations_theoretical = 100 * k_theoretical  # O(Œ∫)

    plt.figure(figsize=(10, 6))

    # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏
    plt.loglog(k_experimental, iterations_n10, 'ro-', label='n=10 (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç)', linewidth=2, markersize=8)
    plt.loglog(k_experimental, iterations_n30, 'bo-', label='n=30 (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç)', linewidth=2, markersize=8)

    # –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –∫—Ä–∏–≤–∞—è
    plt.loglog(k_theoretical, iterations_theoretical, 'k--',
               label='–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è O(Œ∫)', linewidth=2, alpha=0.7)

    plt.xlabel('–ß–∏—Å–ª–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏ Œ∫')
    plt.ylabel('–ß–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π')
    plt.title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–æ–π O(Œ∫)')
    plt.legend()
    plt.grid(True, alpha=0.3, which='both')
    plt.tight_layout()
    plt.show()

# –ó–∞–ø—É—Å–∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
create_final_analysis()
plot_theoretical_comparison()